<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Tracker - Statistics</title>
    <link rel="stylesheet" href="../navigation.css">
    <link rel="stylesheet" href="stats.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>

    <nav class="navigation-container">
        <div class="nav-header">
            <!-- Current Page Indicator -->
            <div class="current-page">
                <span class="page-label">CURRENT:</span>
                <span class="page-name">STATS</span>
            </div>

            <button class="menu-button" id="menuButton">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <span>MENU</span>
            </button>
        </div>

        <!-- Dropdown Menu -->
        <div class="dropdown-menu" id="dropdownMenu">
            <div class="menu-content">
                <!-- Main Pages Section -->
                <div class="menu-section">
                    <div class="section-title">NAVIGATION</div>
                    <div class="menu-items">
                        <!-- Set "active" class on current page -->
                        <a href="../dashboard/dashboard.html" class="menu-item">
                            <span class="menu-icon">üìä</span>
                            <span class="menu-text">DASHBOARD</span>
                        </a>
                        <a href="../stats/stats.html" class="menu-item  active">
                            <span class="menu-icon">üìà</span>
                            <span class="menu-text">STATISTICS</span>
                        </a>
                        <a href="../profile/profile.html" class="menu-item">
                            <span class="menu-icon">üë§</span>
                            <span class="menu-text">PROFILE</span>
                        </a>
                    </div>
                </div>

                <!-- User Info Section -->
                <div class="menu-section user-info-section">
                    <div class="user-info">
                        <div class="user-avatar">JD</div>
                        <div class="user-details">
                            <div class="user-name">JOHN DOE</div>
                            <div class="user-status">HUAWEI GT 2 CONNECTED</div>
                        </div>
                    </div>
                    <div class="menu-items">
                        <a href="../auth/auth.html" class="menu-item">
                            <span class="menu-icon">üö™</span>
                            <span class="menu-text">LOG OUT</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="stats-container">
        <!-- Header with Logo -->
        <header class="stats-header">
            <div class="logo-circle">
                <span class="logo-text">H+</span>
            </div>
            <h1 class="stats-title">HEALTH STATISTICS</h1>
            <div class="time-selector">
                <button class="time-btn active" data-period="daily">DAILY</button>
                <button class="time-btn" data-period="weekly">WEEKLY</button>
                <button class="time-btn" data-period="monthly">MONTHLY</button>
            </div>
        </header>

        <!-- Comparison Toggle -->
        <div class="comparison-section">
            <div class="comparison-toggle">
                <span class="toggle-label">COMPARE WITH PREVIOUS PERIOD</span>
                <div class="toggle-switch">
                    <input type="checkbox" id="compareToggle" class="toggle-input">
                    <label for="compareToggle" class="toggle-slider"></label>
                </div>
            </div>
            <div class="comparison-info" id="comparisonInfo" style="display: none;">
                <span class="comparison-text">COMPARING: THIS WEEK VS LAST WEEK</span>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <!-- Steps Chart -->
            <div class="stat-widget steps-stat">
                <div class="widget-header">
                    <div class="widget-icon">üëü</div>
                    <h3 class="widget-title">STEPS WALKED</h3>
                </div>
                <div class="widget-content">
                    <div class="chart-container large">
                        <canvas id="stepsChart" width="400" height="300"></canvas>
                    </div>
                    <div class="stat-summary">
                        <div class="summary-item">
                            <span class="summary-label">AVERAGE</span>
                            <span class="summary-value">8,247</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">HIGHEST</span>
                            <span class="summary-value">12,156</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">GOAL MET</span>
                            <span class="summary-value">5/7 DAYS</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Heart Rate Chart -->
            <div class="stat-widget heartrate-stat">
                <div class="widget-header">
                    <div class="widget-icon">‚ù§Ô∏è</div>
                    <h3 class="widget-title">HEART RATE TRENDS</h3>
                </div>
                <div class="widget-content">
                    <div class="chart-container large">
                        <canvas id="heartRateStatsChart" width="400" height="300"></canvas>
                    </div>
                    <div class="stat-summary">
                        <div class="summary-item">
                            <span class="summary-label">AVG RESTING</span>
                            <span class="summary-value">68 BPM</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">AVG ACTIVE</span>
                            <span class="summary-value">125 BPM</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">TREND</span>
                            <span class="summary-value trend-up">‚Üó +2 BPM</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sleep Quality Chart -->
            <div class="stat-widget sleep-stat">
                <div class="widget-header">
                    <div class="widget-icon">üò¥</div>
                    <h3 class="widget-title">SLEEP QUALITY</h3>
                </div>
                <div class="widget-content">
                    <div class="chart-container medium">
                        <canvas id="sleepStatsChart" width="300" height="300"></canvas>
                    </div>
                    <div class="stat-summary">
                        <div class="summary-item">
                            <span class="summary-label">AVG HOURS</span>
                            <span class="summary-value">7.2 HRS</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">QUALITY</span>
                            <span class="summary-value">85% GOOD</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">DEEP SLEEP</span>
                            <span class="summary-value">28% AVG</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calories Chart -->
            <div class="stat-widget calorie-stat">
                <div class="widget-header">
                    <div class="widget-icon">üî•</div>
                    <h3 class="widget-title">CALORIES BURNED</h3>
                </div>
                <div class="widget-content">
                    <div class="chart-container medium">
                        <canvas id="calorieStatsChart" width="300" height="300"></canvas>
                    </div>
                    <div class="stat-summary">
                        <div class="summary-item">
                            <span class="summary-label">DAILY AVG</span>
                            <span class="summary-value">2,247</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">HIGHEST DAY</span>
                            <span class="summary-value">3,156</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">GOAL MET</span>
                            <span class="summary-value">6/7 DAYS</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Weekly Comparison Panel -->
        <div class="comparison-panel" id="comparisonPanel" style="display: none;">
            <div class="panel-header">
                <h3 class="panel-title">COMPARISON OVERVIEW</h3>
            </div>
            <div class="comparison-grid">
                <div class="comparison-item">
                    <div class="comparison-icon">üëü</div>
                    <div class="comparison-data">
                        <span class="comparison-metric">STEPS</span>
                        <span class="comparison-change positive">+1,247 (+12%)</span>
                        <span class="comparison-detail">8,247 vs 7,000 avg</span>
                    </div>
                </div>
                <div class="comparison-item">
                    <div class="comparison-icon">‚ù§Ô∏è</div>
                    <div class="comparison-data">
                        <span class="comparison-metric">HEART RATE</span>
                        <span class="comparison-change negative">+2 BPM (+3%)</span>
                        <span class="comparison-detail">68 vs 66 avg resting</span>
                    </div>
                </div>
                <div class="comparison-item">
                    <div class="comparison-icon">üò¥</div>
                    <div class="comparison-data">
                        <span class="comparison-metric">SLEEP</span>
                        <span class="comparison-change positive">+0.5 HRS (+7%)</span>
                        <span class="comparison-detail">7.2 vs 6.7 avg hours</span>
                    </div>
                </div>
                <div class="comparison-item">
                    <div class="comparison-icon">üî•</div>
                    <div class="comparison-data">
                        <span class="comparison-metric">CALORIES</span>
                        <span class="comparison-change positive">+312 (+14%)</span>
                        <span class="comparison-detail">2,247 vs 1,935 avg</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pixel Stars Background -->
        <div class="pixel-stars-bg"></div>
    </div>

    <script>
        let currentPeriod = 'daily';
        let comparisonMode = false;

        // Sample data for different periods
        const sampleData = {
            daily: {
                steps: [8000, 9200, 7500, 10100, 8800, 9500, 8247],
                heartRate: [65, 68, 70, 67, 69, 66, 68],
                sleep: [7.0, 7.5, 6.8, 7.2, 7.1, 7.3, 7.2],
                calories: [2100, 2400, 1900, 2600, 2200, 2300, 2247],
                labels: ['MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT', 'SUN']
            },
            weekly: {
                steps: [52000, 58000, 49000, 61000, 55000],
                heartRate: [67, 69, 65, 68, 68],
                sleep: [49.5, 52.2, 47.6, 50.4, 50.4],
                calories: [14700, 16800, 13300, 18200, 15729],
                labels: ['WK 1', 'WK 2', 'WK 3', 'WK 4', 'WK 5']
            },
            monthly: {
                steps: [230000, 245000, 220000, 255000],
                heartRate: [67, 68, 66, 68],
                sleep: [217, 225, 210, 220],
                calories: [65100, 68400, 62200, 71500],
                labels: ['JAN', 'FEB', 'MAR', 'APR']
            }
        };

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Time period buttons
            document.querySelectorAll('.time-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentPeriod = this.dataset.period;
                    updateCharts();
                    updateComparisonText();
                });
            });

            // Comparison toggle
            document.getElementById('compareToggle').addEventListener('change', function() {
                comparisonMode = this.checked;
                toggleComparison();
            });
        }

        function toggleComparison() {
            const comparisonInfo = document.getElementById('comparisonInfo');
            const comparisonPanel = document.getElementById('comparisonPanel');
            
            if (comparisonMode) {
                comparisonInfo.style.display = 'block';
                comparisonPanel.style.display = 'block';
            } else {
                comparisonInfo.style.display = 'none';
                comparisonPanel.style.display = 'none';
            }
            updateCharts();
        }

        function updateComparisonText() {
            const comparisonText = document.querySelector('.comparison-text');
            const periodTexts = {
                daily: 'THIS WEEK VS LAST WEEK',
                weekly: 'THIS MONTH VS LAST MONTH',
                monthly: 'THIS YEAR VS LAST YEAR'
            };
            comparisonText.textContent = `COMPARING: ${periodTexts[currentPeriod]}`;
        }

        function initializeCharts() {
            createStepsChart();
            createHeartRateStatsChart();
            createSleepStatsChart();
            createCalorieStatsChart();
        }

        function updateCharts() {
            createStepsChart();
            createHeartRateStatsChart();
            createSleepStatsChart();
            createCalorieStatsChart();
        }

        // Steps Bar Chart
        function createStepsChart() {
            const canvas = document.getElementById('stepsChart');
            const ctx = canvas.getContext('2d');
            const data = sampleData[currentPeriod];
            
            canvas.width = 400;
            canvas.height = 300;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.imageSmoothingEnabled = false;
            
            const barWidth = 40;
            const barSpacing = 10;
            const maxValue = Math.max(...data.steps);
            const chartHeight = canvas.height - 60;
            
            // Draw grid
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            for (let i = 0; i <= 5; i++) {
                const y = 40 + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(40, y);
                ctx.lineTo(canvas.width - 20, y);
                ctx.stroke();
            }
            
            // Draw bars
            data.steps.forEach((steps, index) => {
                const x = 50 + index * (barWidth + barSpacing);
                const barHeight = (steps / maxValue) * chartHeight;
                const y = canvas.height - 40 - barHeight;
                
                // Current period bars
                ctx.fillStyle = '#388E3C';
                ctx.fillRect(x, y, barWidth, barHeight);
                
                // Comparison bars (if enabled)
                if (comparisonMode) {
                    const comparisonSteps = data.steps[index] * 0.85; // 15% less for demo
                    const compBarHeight = (comparisonSteps / maxValue) * chartHeight;
                    const compY = canvas.height - 40 - compBarHeight;
                    
                    ctx.fillStyle = '#66BB6A';
                    ctx.globalAlpha = 0.7;
                    ctx.fillRect(x + barWidth + 5, compY, barWidth, compBarHeight);
                    ctx.globalAlpha = 1;
                }
                
                // Labels
                ctx.fillStyle = '#fff';
                ctx.font = '8px "Press Start 2P"';
                ctx.textAlign = 'center';
                ctx.fillText(data.labels[index], x + barWidth/2, canvas.height - 15);
                
                // Values on top of bars
                ctx.fillText(steps.toLocaleString(), x + barWidth/2, y - 5);
            });
        }

        // Heart Rate Line Chart
        function createHeartRateStatsChart() {
            const canvas = document.getElementById('heartRateStatsChart');
            const ctx = canvas.getContext('2d');
            const data = sampleData[currentPeriod];
            
            canvas.width = 400;
            canvas.height = 300;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.imageSmoothingEnabled = false;
            
            const maxValue = Math.max(...data.heartRate) + 10;
            const minValue = Math.min(...data.heartRate) - 10;
            const chartHeight = canvas.height - 80;
            const chartWidth = canvas.width - 80;
            
            // Draw grid
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            for (let i = 0; i <= 6; i++) {
                const y = 40 + (chartHeight / 6) * i;
                ctx.beginPath();
                ctx.moveTo(40, y);
                ctx.lineTo(canvas.width - 20, y);
                ctx.stroke();
            }
            
            // Draw current period line
            ctx.strokeStyle = '#D32F2F';
            ctx.lineWidth = 4;
            ctx.beginPath();
            
            data.heartRate.forEach((hr, index) => {
                const x = 40 + (index / (data.heartRate.length - 1)) * chartWidth;
                const y = 40 + chartHeight - ((hr - minValue) / (maxValue - minValue)) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
                
                // Draw points
                ctx.fillStyle = '#D32F2F';
                ctx.fillRect(x - 3, y - 3, 6, 6);
            });
            
            ctx.stroke();
            
            // Draw comparison line (if enabled)
            if (comparisonMode) {
                ctx.strokeStyle = '#F44336';
                ctx.globalAlpha = 0.7;
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                data.heartRate.forEach((hr, index) => {
                    const compHr = hr - 2; // 2 BPM lower for demo
                    const x = 40 + (index / (data.heartRate.length - 1)) * chartWidth;
                    const y = 40 + chartHeight - ((compHr - minValue) / (maxValue - minValue)) * chartHeight;
                    
                    if (index === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                
                ctx.stroke();
                ctx.globalAlpha = 1;
            }
            
            // Labels
            ctx.fillStyle = '#fff';
            ctx.font = '8px "Press Start 2P"';
            ctx.textAlign = 'center';
            data.labels.forEach((label, index) => {
                const x = 40 + (index / (data.labels.length - 1)) * chartWidth;
                ctx.fillText(label, x, canvas.height - 15);
            });
        }

        // Sleep Stacked Chart
        function createSleepStatsChart() {
            const canvas = document.getElementById('sleepStatsChart');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 300;
            canvas.height = 300;
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const outerRadius = 100;
            const innerRadius = 50;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.imageSmoothingEnabled = false;
            
            // Sleep quality data (percentages)
            const sleepData = [
                { label: 'DEEP', value: 28, color: '#4A148C' },
                { label: 'REM', value: 25, color: '#7B1FA2' },
                { label: 'LIGHT', value: 47, color: '#BA68C8' }
            ];
            
            let currentAngle = 0;
            
            sleepData.forEach(sleep => {
                const sliceAngle = (sleep.value / 100) * 2 * Math.PI;
                
                ctx.fillStyle = sleep.color;
                ctx.beginPath();
                ctx.arc(centerX, centerY, outerRadius, currentAngle, currentAngle + sliceAngle);
                ctx.arc(centerX, centerY, innerRadius, currentAngle + sliceAngle, currentAngle, true);
                ctx.closePath();
                ctx.fill();
                
                // Labels
                const labelAngle = currentAngle + sliceAngle / 2;
                const labelX = centerX + Math.cos(labelAngle) * (outerRadius + 20);
                const labelY = centerY + Math.sin(labelAngle) * (outerRadius + 20);
                
                ctx.fillStyle = '#fff';
                ctx.font = '8px "Press Start 2P"';
                ctx.textAlign = 'center';
                ctx.fillText(`${sleep.label}`, labelX, labelY);
                ctx.fillText(`${sleep.value}%`, labelX, labelY + 12);
                
                currentAngle += sliceAngle;
            });
            
            // Border
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(centerX, centerY, outerRadius, 0, 2 * Math.PI);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.arc(centerX, centerY, innerRadius, 0, 2 * Math.PI);
            ctx.stroke();
        }

        // Calories Pie Chart
        function createCalorieStatsChart() {
            const canvas = document.getElementById('calorieStatsChart');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 300;
            canvas.height = 300;
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 100;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.imageSmoothingEnabled = false;
            
            // Calorie breakdown
            const calorieData = [
                { label: 'EXERCISE', value: 35, color: '#FF6F00' },
                { label: 'DAILY ACTIVITY', value: 45, color: '#FFA000' },
                { label: 'RESTING', value: 20, color: '#FFB74D' }
            ];
            
            let currentAngle = 0;
            
            calorieData.forEach(calorie => {
                const sliceAngle = (calorie.value / 100) * 2 * Math.PI;
                
                ctx.fillStyle = calorie.color;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                ctx.closePath();
                ctx.fill();
                
                // Labels
                const labelAngle = currentAngle + sliceAngle / 2;
                const labelX = centerX + Math.cos(labelAngle) * (radius + 25);
                const labelY = centerY + Math.sin(labelAngle) * (radius + 25);
                
                ctx.fillStyle = '#fff';
                ctx.font = '6px "Press Start 2P"';
                ctx.textAlign = 'center';
                ctx.fillText(calorie.label, labelX, labelY);
                ctx.fillText(`${calorie.value}%`, labelX, labelY + 10);
                
                currentAngle += sliceAngle;
            });
            
            // Border
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.stroke();
        }
    </script>
        <script src="../navigation.js"></script>
</body>
</html>